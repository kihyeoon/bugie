# Bugie MVP 제작 계획

## 📋 프로젝트 개요

### MVP 목표

- **기간**: 3개월 (12주)
- **목표**: 부부가 함께 사용할 수 있는 실시간 공유 가계부의 핵심 기능 구현
- **플랫폼**: Web (Next.js) + Mobile (Expo)
- **핵심 가치**: 실시간 동기화, 직관적 UI, 안전한 데이터 관리

### MVP 범위

- ✅ 사용자 인증 및 프로필 관리
- ✅ 가계부 생성 및 공유
- ✅ 수입/지출 입력 및 관리
- ✅ 실시간 동기화 (3초 이내)
- ✅ 예산 설정 및 알림
- ❌ AI 자동 분류 (Phase 2)
- ❌ 영수증 OCR (Phase 2)

## 🚀 Phase 1: MVP 핵심 기능 (3개월)

### 1주차: 프로젝트 초기 설정

- [x] Supabase 프로젝트 생성
- [x] 환경 변수 설정 (.env.local)
- [x] 공통 타입 패키지 생성 (@repo/types)
- [x] ESLint/Prettier 설정 통일
- [x] Git 브랜치 전략 수립

### 2-3주차: 인증 시스템 ⏳ **[90% 완료]**

- [x] Supabase Auth 설정
  - [x] 소셜 로그인 (Google 완료, Apple/Kakao 향후)
  - [x] 세션 관리 및 토큰 처리
- [x] 인증 UI 구현
  - [x] 로그인 페이지 (Google Sign-In 버튼)
  - [ ] 프로필 설정 페이지 (부분 완료 - 닉네임만 구현)
- [x] 인증 상태 관리
  - [x] Context API 설정 (AuthProvider)
  - [x] 보호된 라우트 구현 (프로필 완성도 체크)
  - [x] 세션 관리 (자동 로그인)

**완료된 기능**:

- Google Sign-In SDK 통합
- 서비스 레이어 아키텍처 적용 (authService, googleAuth, profileService)
- 프로필 완성도 기반 자동 라우팅

**미완성 항목**:

- 프로필 사진 설정 기능
- 기본 통화 선택 (KRW/USD 등)
- 이용약관 동의 UI

### 4-5주차: 데이터베이스 설계 및 기본 CRUD ✅ **[완료]**

- [x] 데이터베이스 스키마 설계 (**완료**)
  - [x] profiles 테이블 (사용자 프로필)
  - [x] ledgers 테이블 (가계부)
  - [x] ledger_members 테이블 (공유 멤버)
  - [x] transactions 테이블 (거래 내역)
  - [x] categories & category_templates 테이블 (하이브리드 카테고리)
  - [x] budgets 테이블 (예산)
- [x] Supabase 마이그레이션 작성 (**완료**)
- [x] Row Level Security (RLS) 정책 설정 (**완료**)
- [x] 기본 CRUD API 구현 (**완료**)
  - [x] 가계부 생성/조회/수정/삭제
  - [x] 거래 내역 CRUD
  - [x] 카테고리 관리
  - [x] 멤버 초대 및 권한 관리

**완료된 작업**:

- 하이브리드 카테고리 시스템 설계 (템플릿 + 커스텀)
- 다중 사용자 권한 시스템 (owner/admin/member/viewer)
- Soft Delete 패턴 적용
- 성능 최적화 인덱스 설정
- 데이터베이스 뷰 및 함수 구현
- **@repo/core 패키지 생성** - 클린 아키텍처 기반 비즈니스 로직 레이어
  - Domain Layer: 엔티티, 비즈니스 규칙
  - Application Layer: 서비스, 유스케이스
  - Infrastructure Layer: Supabase 리포지토리, 매퍼

### 6-7주차: 핵심 기능 구현 ⏳ **[진행중]**

#### 탭 네비게이션 구축 ✅ **[완료]**

- [x] 하단 탭 바 구현 (홈/추가/더보기)
- [x] 탭 아이콘 및 레이블 디자인
- [x] 탭 전환 애니메이션
- [x] 활성 탭 하이라이트 효과
- [x] 중앙 플로팅 추가 버튼 커스텀 스타일링

#### [TAB-01] 홈 화면 (네이티브) ✅ **[완료]**

- [x] 월간 캘린더 컴포넌트 구현
  - [x] 일별 수입/지출 표시 (파란색: 수입, 빨간색: 지출)
  - [x] 오늘 날짜 원형 테두리 하이라이트
  - [x] 좌우 스와이프로 월 변경
  - [x] 다른 달 날짜 회색 처리
- [x] 월간 요약 섹션
  - [x] 수입/지출/잔액 표시 UI
  - [x] 실제 데이터 계산 및 연동
  - [ ] 전월 대비 증감률 화살표 표시 (향후)
- [ ] 캘린더 날짜 탭 → 거래 목록으로 네비게이션 (향후)

**완료된 작업**:

- 캘린더 컴포넌트 전체 구현 완료
- Supabase API 연동으로 실제 데이터 표시
- 캘린더와 카드 레이아웃 이슈 해결
- LedgerContext로 가계부 관리
- 월간 데이터 hooks (useMonthlyData) 구현

#### [TAB-03] 빠른 입력 화면 (네이티브) ✅ **[100% 완료]**

- [x] 커스텀 숫자 키패드 UI
  - [x] 금액 입력 로직 구현
  - [x] 천 단위 콤마 자동 삽입 (toLocaleString 활용)
  - [x] 백스페이스 및 00 버튼 구현
- [x] 수입/지출 토글 스위치 (ToggleSwitch 컴포넌트 사용)
- [x] 카테고리 선택 UI
  - [x] 카테고리 칩 버튼 구현
  - [ ] 최근 사용 카테고리 표시 (Phase 2 기능)
  - [x] 카테고리 전체 보기 모달 (CategoryBottomSheet)
  - [x] 커스텀 카테고리 추가 (+) 버튼 (AddCategoryModal)
- [x] 제목 입력 필드 (필수 항목)
- [x] 메모 입력 필드 (선택사항, 단일 줄, 고정 높이)
- [x] 입력 필드 간 키보드 포커스 전환
  - [x] 금액 → 카테고리/제목 → 메모 순서로 자동 포커스
  - [x] 카테고리 선택 후 제목으로 자동 포커스
- [x] 저장하기 버튼 (비활성화 상태 구현)
- [x] 저장 후 홈 화면으로 이동 (router.replace 활용)

#### [STACK-01] 거래 목록 화면 (네이티브) ✅ **[80% 완료]**

- [x] 스크롤 반응형 캘린더 구현
  - [x] 상단 스크롤 시 월간 뷰로 확장 (50px 임계값)
  - [x] 하단 스크롤 시 주간 뷰로 축소
  - [x] 300ms ease-out 애니메이션
  - [x] useNativeDriver로 성능 최적화
- [x] 캘린더에서 드래그 제스처로 캘린더 뷰 전환
- [x] 거래 목록 SectionList 구현
  - [x] 일별 섹션 헤더 ("📅 1월 9일 (목)")
  - [x] 카테고리 아이콘 및 색상 표시
  - [x] 금액 포맷팅 (수입: +, 지출: -)
  - [x] getItemLayout으로 스크롤 성능 최적화
- [ ] 검색 (Phase 2로 이동)
- [ ] 스와이프 액션 (삭제/수정) (Phase 2로 이동)
- [x] 하단 요약 (일별/월별 합계)
- [x] 캘린더-리스트 양방향 동기화

#### [TAB-04] 더보기 탭 메뉴 ✅ **[완료]**

- [x] 메뉴 리스트 UI
  - [x] 가계부 관리 → 가계부 관리 화면 (네이티브)
  - [x] 프로필 설정 → 프로필 화면 (네이티브)
  - [x] 앱 설정 → 설정 화면 (네이티브 - TODO)
- [x] 각 메뉴 아이콘 및 설명 텍스트
- [x] 메뉴 항목 클릭 시 화면 이동
- [x] 로그아웃 기능

#### [LEDGER-01] 가계부 관리 화면 (네이티브) ✅ **[완료]**

- [x] 가계부 목록 표시
  - [x] 참여 중인 가계부 리스트
  - [x] 현재 선택된 가계부 표시 (✓)
  - [x] 새 가계부 만들기 버튼
- [x] 가계부 전환 기능
- [x] 가계부 설정 이동
- [x] **멤버 관리 기능**
  - [x] 멤버 목록 화면 (ViewMembersModal)
    - [x] 현재 멤버 리스트 표시
    - [x] 멤버별 권한 표시 (owner/member)
    - [x] 프로필 이니셜 및 이름
    - [x] 멤버 내보내기 기능 (권한에 따라)
  - [x] 멤버 초대 화면 (InviteMemberModal)
    - [x] 이메일 입력 필드
    - [x] 권한 선택 (member로 고정)
    - [x] 초대 전송 버튼
  - [x] 권한 시스템
    - [x] owner: 모든 권한 (가계부 삭제, 멤버 관리)
    - [x] member: 거래 입력/수정
  - [x] 멤버 액션 UX 개선
    - [x] 롱프레스 + 더보기 버튼 하이브리드 방식
    - [x] iOS ActionSheetIOS / Android Alert.alert
    - [x] 햅틱 피드백 지원

#### [PROFILE-01] 프로필 설정 화면 (네이티브) ✅ **[완료]**

- [x] 프로필 정보 표시
  - [ ] 프로필 사진 (Phase 2로 이동)
  - [x] 닉네임
  - [x] 이메일 (읽기 전용)
- [x] 프로필 편집 기능
  - [ ] 프로필 사진 변경 (Phase 2로 이동)
  - [x] 닉네임 변경
- [x] 계정 관리
  - [x] 로그아웃
  - [x] 회원 탈퇴 (30일 유예 기간 포함)

#### [SETTINGS-01] 앱 설정 화면 (네이티브) ❌ **[Phase 2로 이동]**

Phase 2로 이동 사유:

- 푸시 알림 기능은 서버 인프라 구축 필요 (FCM/APNS)
- 예산 기능이 아직 미구현 상태
- 캐시 관리는 이미지/오프라인 기능 구현 후 필요

- [ ] 알림 설정
  - [ ] 푸시 알림 on/off
  - [ ] 예산 초과 알림
  - [ ] 멤버 초대 알림
- [ ] 일반 설정
  - [ ] 앱 버전 정보
  - [ ] 캐시 삭제
- [ ] 테마 설정 (Phase 2)
  - [ ] 다크모드 토글

### 8-9주차: 기타 핵심 기능

#### 실시간 동기화

- [ ] Supabase Realtime 채널 설정
- [ ] 거래 내역 실시간 업데이트
- [ ] 멤버 변경사항 실시간 반영
- [ ] 낙관적 업데이트 구현
- [ ] 오프라인 큐 관리

### 10-11주차: 예산 관리 및 추가 기능

#### 예산 관리 기능

- [ ] 예산 설정 화면 (웹뷰)
  - [ ] 월별/연간 예산 토글
  - [ ] 카테고리별 예산 금액 입력
  - [ ] 예산 사용률 프로그레스 바
  - [ ] 예산 수정/삭제 기능
- [ ] 예산 알림 시스템
  - [ ] 80% 도달 시 경고 알림
  - [ ] 100% 초과 시 긴급 알림
  - [ ] 푸시 알림 권한 요청
  - [ ] 알림 설정 화면

#### 거래 상세/수정 화면 (네이티브) ✅ **[100% 완료]**

- [x] 거래 상세 정보 표시
  - [x] 금액, 카테고리, 제목, 메모, 날짜 표시
  - [x] 수입/지출 타입별 색상 구분
- [x] 거래 수정 기능 (인라인 모달 편집)
  - [x] EditAmountModal - 커스텀 숫자 키패드
  - [x] EditCategoryModal - 카테고리 선택
  - [x] EditTextModal - 제목/메모 편집
  - [x] EditDateModal - 날짜 선택
  - [x] 모달 애니메이션 최적화
- [x] 거래 삭제 기능
  - [x] 삭제 확인 다이얼로그
  - [x] Soft Delete 구현 (SECURITY DEFINER 함수)
- [x] 수정 내역 실시간 반영
  - [x] useFocusEffect로 화면 간 동기화
  - [x] 낙관적 업데이트

#### 프로필 관리 (웹뷰)

- [ ] 프로필 정보 수정
  - [ ] 닉네임 변경
  - [ ] 프로필 사진 업로드
  - [ ] 기본 통화 설정
- [ ] 계정 설정
  - [ ] 알림 설정
  - [ ] 언어 설정
  - [ ] 로그아웃
  - [ ] 회원 탈퇴

### 12주차: UI/UX 개선 및 테스트

- [ ] UI 컴포넌트 정리
  - [ ] 공통 컴포넌트 추출
  - [ ] 디자인 시스템 문서화
  - [ ] 다크모드 지원
- [ ] 성능 최적화
  - [ ] 이미지 최적화
  - [ ] 번들 크기 최적화
  - [ ] 로딩 상태 개선
- [ ] 테스트
  - [ ] 단위 테스트 작성
  - [ ] E2E 테스트 시나리오
  - [ ] 사용성 테스트

## 📱 웹뷰 활용 전략

### 웹뷰를 사용하는 이유

- **빠른 업데이트**: 앱 스토어 심사 없이 즉시 기능 개선 및 버그 수정 가능
- **복잡한 UI 구현**: 차트, 그래프, 애니메이션 등 웹 기술로 더 쉽고 풍부하게 구현
- **유지보수 용이성**: 하나의 코드베이스로 관리하여 버그 수정 및 기능 추가 효율화
- **네이티브 제어**: 모든 네비게이션과 상태는 네이티브 앱이 관리

### 웹뷰 사용 페이지

| 페이지              | 사용 이유                   | 구현 내용                                     |
| ------------------- | --------------------------- | --------------------------------------------- |
| **리포트 대시보드** | 복잡한 차트와 데이터 시각화 | 월별/카테고리별 지출 차트, 예산 사용률 그래프 |
| **거래 상세/수정**  | 폼 UI와 데이터 연동         | 거래 정보 표시 및 수정 폼                     |
| **가계부 설정**     | 폼 중심의 설정 화면         | 가계부 정보 수정, 멤버 관리, 카테고리 설정    |
| **프로필 관리**     | 간단한 CRUD 작업            | 사용자 정보 수정, 알림 설정                   |
| **공유 및 초대**    | 복잡한 권한 관리 UI         | 멤버 초대, 권한 설정, 공유 링크 생성          |

### 네이티브 구현 페이지

| 페이지             | 네이티브 사용 이유            | 특징                           |
| ------------------ | ----------------------------- | ------------------------------ |
| **거래 빠른 입력** | 빠른 반응성과 네이티브 키보드 | 숫자 키패드, 제스처 인식       |
| **홈 탭 (캘린더)** | 앱 시작 시 빠른 로딩          | 월간 캘린더, 일별 수입/지출    |
| **거래 목록**      | 스크롤 성능과 캘린더 연동     | 확장/축소 캘린더, 무한 스크롤  |
| **푸시 알림**      | OS 레벨 기능 활용             | 예산 초과 알림, 공유 초대 알림 |
| **카메라 (향후)**  | 디바이스 하드웨어 접근        | 영수증 촬영                    |

### 웹뷰 통신 구조

```
Native App ←→ WebView Bridge ←→ Next.js Web App
     ↓                                    ↓
  Native Storage              Supabase Backend
  (토큰, 설정)                  (데이터, 인증)
```

### 웹뷰 성능 최적화 전략

- **프리로딩**: 자주 사용하는 페이지 미리 로드
- **캐싱**: 정적 리소스 적극적 캐싱
- **레이지 로딩**: 필요한 컴포넌트만 동적 로드
- **번들 최적화**: 페이지별 코드 스플리팅

## 🛠 기술 스택

### Frontend

- **Web**: Next.js 15, React 19, Tailwind CSS
- **Native**: Expo SDK 53, React Native 0.79
- **상태 관리**: Context API + Supabase Realtime
- **UI 라이브러리**: @repo/ui (공통 컴포넌트)
- **폼 관리**: React Hook Form
- **차트**: Recharts (Web) / Victory Native (Mobile)

### API 구현 방식

- **기본 CRUD**: Supabase 자동 생성 REST API
- **복잡한 비즈니스 로직**: Supabase Edge Functions
- **클라이언트 SDK**: @supabase/supabase-js
- **실시간 데이터**: Supabase Realtime 구독

### Backend

- **Database**: Supabase PostgreSQL
- **Authentication**: Supabase Auth
- **Realtime**: Supabase Realtime
- **Storage**: Supabase Storage
- **Edge Functions**: Supabase Edge Functions (필요시)

### DevOps

- **Native 빌드**: Expo EAS
- **모니터링**: Sentry
- **CI/CD**: GitHub Actions
- **웹뷰 콘텐츠**: 네이티브 앱에 포함 또는 CDN 호스팅

## 📊 성공 지표

### 기술적 지표

- [ ] 페이지 로드 시간 < 1.5초
- [ ] 실시간 동기화 지연 < 3초
- [ ] Lighthouse 점수 > 90
- [ ] 앱 크기 < 50MB

### 기능적 지표

- [ ] 모든 핵심 기능 구현 완료
- [ ] 크로스 플랫폼 일관성
- [ ] 오프라인 지원 (기본)
- [ ] 다국어 지원 준비

## 🚧 리스크 및 대응 방안

### 기술적 리스크

1. **실시간 동기화 성능**
   - 대응: 낙관적 업데이트, 디바운싱 적용
2. **크로스 플랫폼 UI 일관성**
   - 대응: 공통 컴포넌트 라이브러리 확대

3. **데이터 보안**
   - 대응: RLS 정책 철저히 구현, 정기 보안 점검

### 일정 리스크

1. **예상보다 긴 개발 시간**
   - 대응: 주간 스프린트 리뷰, 우선순위 재조정

2. **예기치 않은 기술적 난제**
   - 대응: 기술 스파이크 시간 확보, 대안 준비

## 📝 다음 단계 (Phase 2)

### 4-6개월차 추가 기능

- [ ] **리포트 대시보드** (탭 추가)
  - [ ] 월별 수입/지출 트렌드 차트
  - [ ] 카테고리별 지출 분석
  - [ ] 예산 대비 실제 지출
  - [ ] 지출 패턴 인사이트
- [ ] **앱 설정 화면**
  - [ ] 푸시 알림 설정 (예산 초과, 멤버 초대)
  - [ ] 캐시 관리 기능
  - [ ] 앱 버전 정보 및 업데이트 확인
  - [ ] 약관 및 개인정보처리방침
- [ ] AI 기반 자동 카테고리 분류
- [ ] 영수증 OCR 스캔
- [ ] 고급 분석 및 인사이트
- [ ] 예산 추천 시스템
- [ ] 목표 저축 기능
- [ ] 정기 거래 자동 입력
- [ ] 엑셀/PDF 내보내기
- [ ] 음성 입력 기능

### 7-9개월차 확장 기능

- [ ] 가족 구성원 관리 (자녀 용돈)
- [ ] 투자 포트폴리오 연동
- [ ] 세금 계산 도우미
- [ ] 커뮤니티 기능
- [ ] 프리미엄 구독 모델

---

이 문서는 개발 진행에 따라 지속적으로 업데이트됩니다.

## 📈 현재 진행 상황 (2025-08-24)

### ✅ 완료된 마일스톤

1. **인증 시스템** - Google Sign-In 완전 구현
2. **데이터베이스 설계** - 하이브리드 카테고리 시스템 포함 완료
3. **비즈니스 로직 레이어** - @repo/core 패키지 생성 완료
   - 클린 아키텍처 3계층 구조 적용
   - LedgerService, TransactionService, PermissionService 구현
   - Supabase 리포지토리 및 매퍼 구현
4. **홈 화면** - 탭 네비게이션과 캘린더 뷰 완료
5. **빠른 입력 화면 UX** - 키보드 포커스 체인 및 입력 필드 개선
6. **커스텀 카테고리** - 사용자 정의 카테고리 추가 기능 구현
7. **거래 목록 화면** - 스크롤 반응형 캘린더와 거래 리스트 통합 완료
8. **거래 상세/수정 화면** - 네이티브로 구현, 인라인 편집 모달 완료
9. **가계부 관리 시스템** - 가계부 생성, 설정, 멤버 관리 완료
   - 가계부 설정 화면 (이름, 설명 수정)
   - 멤버 초대/내보내기 기능
   - 권한 기반 UI/UX
   - 가계부 삭제 및 나가기 기능
10. **프로필 설정 시스템** - 닉네임 변경, 계정 정보 관리
    - 프로필 상세 정보 조회 및 표시
    - EditTextModal을 통한 닉네임 수정
    - 이메일 및 가입일 표시
    - 로그아웃 기능 구현
11. **회원 탈퇴 시스템** - soft delete + 30일 유예 기간 후 완전 삭제
    - soft_delete_profile RPC 함수
    - DeleteAccountModal 컴포넌트 (탈퇴 의사 확인)
    - GitHub Actions 자동화 (매일 새벽 3시 실행)
    - process_account_deletions로 30일 후 완전 삭제
    - ON DELETE SET NULL로 데이터 무결성 유지

### 📊 진행률

- **전체 진행률**: 85% (9주차 진행중)
- **인증**: 95% ⏳ (프로필 사진 기능만 미완성)
- **데이터베이스**: 100% ✅ (설계 및 CRUD 구현 완료)
- **비즈니스 로직**: 100% ✅ (core 패키지 완료)
- **UI 구현**: 90% (대부분의 핵심 화면 완료)
- **홈 화면**: 100% ✅ (캘린더, 월간 요약 완료)
- **빠른 입력**: 100% ✅ (모든 기능 구현 완료)
- **거래 목록**: 80% ✅ (검색/필터는 Phase 2)
- **거래 상세/수정**: 100% ✅ (네이티브로 구현 완료)
- **가계부 관리**: 100% ✅ (생성, 설정, 멤버 관리 완료)
- **더보기 탭**: 100% ✅ (메뉴 구성 및 네비게이션 완료)
- **프로필 설정**: 100% ✅ (닉네임 변경, 회원 탈퇴 완료)

---

## 📌 MVP에서 제외된 기능 목록

### 인증 시스템

- [ ] Apple Sign-In (Google만 구현)
- [ ] Kakao 로그인
- [ ] 이용약관 동의 UI

### 거래 관리

- [ ] 거래 목록 검색 기능
- [ ] 거래 목록 필터링
- [ ] 스와이프 액션 (삭제/수정)
- [ ] 최근 사용 카테고리 표시

### 가계부 관리

- [ ] 통화 변경 기능 (KRW 고정)
- [ ] 초대 링크 생성
- [ ] QR 코드 초대
- [ ] 가계부 공유 시스템 (고급)

### 리포트/대시보드

- [ ] 리포트 탭 전체 (웹뷰)
- [ ] 예산 관리 기능
- [ ] 통계 차트
- [ ] 데이터 내보내기

### 프로필 관리

- [ ] 프로필 사진 관리

### 기타

- [ ] 웹뷰 통합
- [ ] 실시간 동기화
- [ ] 푸시 알림 (기본 on/off만 구현)
- [ ] 오프라인 지원
- [ ] 다크모드 (완성도 개선 필요)

---

마지막 업데이트: 2025-08-28
