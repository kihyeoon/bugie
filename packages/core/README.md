# @repo/core

Bugie ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ë„ë©”ì¸ ê·œì¹™ì„ ë‹´ë‹¹í•˜ëŠ” ì½”ì–´ íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤.

## ğŸ“‹ ê°œìš”

`@repo/core`ëŠ” í´ë¦° ì•„í‚¤í…ì²˜ ì›ì¹™ì„ ë”°ë¼ ì„¤ê³„ëœ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤. ë„ë©”ì¸ ì¤‘ì‹¬ ì„¤ê³„(DDD)ë¥¼ í†µí•´ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì„ ëª…í™•í•˜ê²Œ í‘œí˜„í•˜ê³ , ì™¸ë¶€ ì˜ì¡´ì„±ìœ¼ë¡œë¶€í„° ë…ë¦½ì ì¸ êµ¬ì¡°ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.

## âœ¨ ì£¼ìš” íŠ¹ì§•

- **ğŸ›ï¸ í´ë¦° ì•„í‚¤í…ì²˜**: Domain, Application, Infrastructure 3ê³„ì¸µ êµ¬ì¡°
- **ğŸ”’ íƒ€ì… ì•ˆì „ì„±**: TypeScriptë¥¼ í™œìš©í•œ ê°•ë ¥í•œ íƒ€ì… ì‹œìŠ¤í…œ
- **ğŸ”„ ì˜ì¡´ì„± ì—­ì „**: ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ëŠìŠ¨í•œ ê²°í•©
- **ğŸ“¦ ë„ë©”ì¸ ë…ë¦½ì„±**: ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„± ì—†ëŠ” ìˆœìˆ˜í•œ ë„ë©”ì¸ ë¡œì§
- **ğŸ§ª í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**: ê° ê³„ì¸µì˜ ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Presentation Layer                   â”‚
â”‚                  (Web App / Native App)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ Uses
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Application Layer                      â”‚
â”‚              (Services / Use Cases)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ LedgerService    â€¢ TransactionService         â”‚    â”‚
â”‚  â”‚ â€¢ Input/Output DTOs â€¢ Orchestration Logic       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ Uses
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Domain Layer                        â”‚
â”‚              (Entities / Business Rules)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ Entities (Ledger, Transaction, Category)      â”‚    â”‚
â”‚  â”‚ â€¢ Business Rules â€¢ Value Objects                â”‚    â”‚
â”‚  â”‚ â€¢ Domain Errors  â€¢ Repository Interfaces        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ Implements
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Infrastructure Layer                    â”‚
â”‚            (External Systems / Adapters)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ Supabase Repositories â€¢ Auth Service          â”‚    â”‚
â”‚  â”‚ â€¢ DB â†” Domain Mappers  â€¢ External APIs          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê³„ì¸µë³„ ì±…ì„

#### Domain Layer (`/domain`)

- **ì—­í• **: í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ê·œì¹™ ì •ì˜
- **íŠ¹ì§•**: ì™¸ë¶€ ì˜ì¡´ì„± ì—†ìŒ, ìˆœìˆ˜ TypeScript
- **êµ¬ì„±ìš”ì†Œ**:
  - Entities (LedgerEntity, TransactionEntity)
  - Business Rules (LedgerRules, TransactionRules)
  - Repository Interfaces
  - Domain Errors

#### Application Layer (`/application`)

- **ì—­í• **: ìœ ìŠ¤ì¼€ì´ìŠ¤ êµ¬í˜„, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¡°ìœ¨
- **íŠ¹ì§•**: ë„ë©”ì¸ ë ˆì´ì–´ë§Œ ì˜ì¡´
- **êµ¬ì„±ìš”ì†Œ**:
  - Services (LedgerService, TransactionService)
  - Input/Output DTOs
  - Use Case Implementation

#### Infrastructure Layer (`/infrastructure`)

- **ì—­í• **: ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ í†µí•©
- **íŠ¹ì§•**: ë„ë©”ì¸ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
- **êµ¬ì„±ìš”ì†Œ**:
  - Supabase Repositories
  - DB â†” Domain Mappers
  - External Service Adapters

## ğŸš€ ì„¤ì¹˜ ë° ì‚¬ìš©ë²•

### ì„¤ì¹˜

```bash
pnpm add @repo/core
```

### ê¸°ë³¸ ì‚¬ìš©ë²•

```typescript
import { createLedgerService, createTransactionService } from '@repo/core';
import { createClient } from '@supabase/supabase-js';

// Supabase í´ë¼ì´ì–¸íŠ¸ ìƒì„±
const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL!,
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
);

// ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
const ledgerService = createLedgerService(supabase);
const transactionService = createTransactionService(supabase);

// ê°€ê³„ë¶€ ìƒì„± ì˜ˆì œ
const newLedger = await ledgerService.createLedger({
  name: 'ìš°ë¦¬ì§‘ ê°€ê³„ë¶€',
  description: 'ê°€ì¡± ê³µë™ ê°€ê³„ë¶€',
  currency: 'KRW',
});

// ê±°ë˜ ë‚´ì—­ ì¡°íšŒ ì˜ˆì œ
const transactions = await transactionService.getTransactions({
  ledgerId: newLedger.id,
  startDate: '2025-01-01',
  endDate: '2025-01-31',
  limit: 20,
});
```

## ğŸ“š ì£¼ìš” API

### LedgerService

| ë©”ì„œë“œ                    | ì„¤ëª…                      | ë°˜í™˜ íƒ€ì…                |
| ------------------------- | ------------------------- | ------------------------ |
| `getLedgers()`            | ì‚¬ìš©ìì˜ ëª¨ë“  ê°€ê³„ë¶€ ì¡°íšŒ | `LedgerWithMembers[]`    |
| `getLedger(id)`           | íŠ¹ì • ê°€ê³„ë¶€ ìƒì„¸ ì¡°íšŒ     | `LedgerDetail`           |
| `createLedger(input)`     | ìƒˆ ê°€ê³„ë¶€ ìƒì„±            | `{ id, name, currency }` |
| `updateLedger(id, input)` | ê°€ê³„ë¶€ ì •ë³´ ìˆ˜ì •          | `void`                   |
| `deleteLedger(id)`        | ê°€ê³„ë¶€ ì‚­ì œ               | `void`                   |
| `inviteMember(input)`     | ë©¤ë²„ ì´ˆëŒ€                 | `void`                   |

### TransactionService

| ë©”ì„œë“œ                                     | ì„¤ëª…                | ë°˜í™˜ íƒ€ì…                |
| ------------------------------------------ | ------------------- | ------------------------ |
| `getTransactions(filter)`                  | ê±°ë˜ ë‚´ì—­ ì¡°íšŒ      | `{ data, count }`        |
| `getTransaction(id)`                       | íŠ¹ì • ê±°ë˜ ìƒì„¸ ì¡°íšŒ | `TransactionWithDetails` |
| `createTransaction(input)`                 | ìƒˆ ê±°ë˜ ìƒì„±        | `string` (ID)            |
| `updateTransaction(id, input)`             | ê±°ë˜ ìˆ˜ì •           | `void`                   |
| `deleteTransaction(id)`                    | ê±°ë˜ ì‚­ì œ           | `void`                   |
| `getMonthlySummary(ledgerId, year, month)` | ì›”ë³„ ìš”ì•½           | `MonthlySummary`         |

### ì£¼ìš” íƒ€ì…

```typescript
// ë„ë©”ì¸ íƒ€ì…
export type MemberRole = 'owner' | 'admin' | 'member' | 'viewer';
export type CategoryType = 'income' | 'expense';
export type CurrencyCode = 'KRW' | 'USD' | 'EUR' | 'JPY';

// ì…ë ¥ íƒ€ì…
export interface CreateLedgerInput {
  name: string;
  description?: string;
  currency?: CurrencyCode;
}

export interface CreateTransactionInput {
  ledgerId: string;
  categoryId: string;
  amount: number;
  type: CategoryType;
  title: string;
  description?: string;
  transactionDate?: string;
}

// ì—ëŸ¬ íƒ€ì…
export class DomainError extends Error {}
export class ValidationError extends DomainError {}
export class UnauthorizedError extends DomainError {}
export class NotFoundError extends DomainError {}
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
src/
â”œâ”€â”€ domain/                    # ë„ë©”ì¸ ë ˆì´ì–´
â”‚   â”œâ”€â”€ auth/                 # ì¸ì¦ ë„ë©”ì¸
â”‚   â”‚   â””â”€â”€ types.ts         # ì¸ì¦ ê´€ë ¨ íƒ€ì…
â”‚   â”œâ”€â”€ ledger/              # ê°€ê³„ë¶€ ë„ë©”ì¸
â”‚   â”‚   â”œâ”€â”€ types.ts        # ì—”í‹°í‹° ë° ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â””â”€â”€ rules.ts        # ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
â”‚   â”œâ”€â”€ transaction/         # ê±°ë˜ ë„ë©”ì¸
â”‚   â”‚   â”œâ”€â”€ types.ts        # ì—”í‹°í‹° ë° ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â””â”€â”€ rules.ts        # ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
â”‚   â””â”€â”€ shared/              # ê³µí†µ ë„ë©”ì¸
â”‚       â”œâ”€â”€ types.ts        # ê³µí†µ íƒ€ì… (EntityId, DomainDate ë“±)
â”‚       â””â”€â”€ errors.ts       # ë„ë©”ì¸ ì—ëŸ¬
â”‚
â”œâ”€â”€ application/              # ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆì´ì–´
â”‚   â”œâ”€â”€ ledger/              # ê°€ê³„ë¶€ ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ LedgerService.ts
â”‚   â”‚   â””â”€â”€ types.ts        # Input/Output DTOs
â”‚   â””â”€â”€ transaction/         # ê±°ë˜ ì„œë¹„ìŠ¤
â”‚       â”œâ”€â”€ TransactionService.ts
â”‚       â””â”€â”€ types.ts        # Input/Output DTOs
â”‚
â”œâ”€â”€ infrastructure/           # ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ë ˆì´ì–´
â”‚   â””â”€â”€ supabase/            # Supabase í†µí•©
â”‚       â”œâ”€â”€ auth/            # ì¸ì¦ ì„œë¹„ìŠ¤ êµ¬í˜„
â”‚       â”‚   â””â”€â”€ SupabaseAuthService.ts
â”‚       â”œâ”€â”€ mappers/         # DB â†” Domain ë§¤í•‘
â”‚       â”‚   â”œâ”€â”€ LedgerMapper.ts
â”‚       â”‚   â”œâ”€â”€ CategoryMapper.ts
â”‚       â”‚   â””â”€â”€ TransactionMapper.ts
â”‚       â””â”€â”€ repositories/    # ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„
â”‚           â”œâ”€â”€ LedgerRepository.ts
â”‚           â””â”€â”€ TransactionRepository.ts
â”‚
â”œâ”€â”€ shared/                   # UI ë ˆì´ì–´ìš© ê³µìœ  íƒ€ì…
â”‚   â””â”€â”€ types.ts             # API ì‘ë‹µ íƒ€ì…
â”‚
â””â”€â”€ index.ts                 # íŒ¨í‚¤ì§€ ì§„ì…ì 
```

## ğŸ”§ ê°œë°œ ê°€ì´ë“œ

### ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€í•˜ê¸°

1. **ë„ë©”ì¸ ë ˆì´ì–´**: ì—”í‹°í‹°ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì •ì˜
2. **ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆì´ì–´**: ì„œë¹„ìŠ¤ì™€ ìœ ìŠ¤ì¼€ì´ìŠ¤ êµ¬í˜„
3. **ì¸í”„ë¼ ë ˆì´ì–´**: ë¦¬í¬ì§€í† ë¦¬ì™€ ë§¤í¼ êµ¬í˜„
4. **íƒ€ì… export**: index.tsì— í•„ìš”í•œ íƒ€ì… ì¶”ê°€

### ì½”ë”© ì»¨ë²¤ì…˜

- ë„ë©”ì¸ ë ˆì´ì–´ëŠ” ì™¸ë¶€ ì˜ì¡´ì„±ì„ ê°€ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤
- ëª¨ë“  public APIëŠ” ëª…í™•í•œ íƒ€ì…ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤
- ì—ëŸ¬ëŠ” ë„ë©”ì¸ ì—ëŸ¬ë¥¼ ìƒì†ë°›ì•„ êµ¬í˜„í•©ë‹ˆë‹¤
- ë¦¬í¬ì§€í† ë¦¬ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ë¨¼ì € ì •ì˜í•©ë‹ˆë‹¤

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” Bugie ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¼ë¶€ì…ë‹ˆë‹¤.
